{% extends "base.html" %}
{% block title %}App Search - Results{% endblock %}

{% block content %}
<div class="container">
    <div class="header">
        <h1>🔍 App Search Engine</h1>
        <form method="get" class="search-bar">
            <input type="text" name="q" placeholder="Search for apps..." value="{{ query }}">
            <button type="submit">Search</button>
        </form>
    </div>

    {% if show_results and apps %}
    <div class="results-container">
        <div class="main-result">
            <div class="main-result-header">
                <div class="crown-icon">👑</div>
                <h2>Best Match</h2>
            </div>
            {% with app=apps.0 %}
            <div class="main-app-card app-card">
                <div class="app-header">
                    <div class="app-icon">{{ app.app_name|slice:":2"|upper }}</div>
                    <div class="app-title">{{ app.app_name }}</div>
                </div>
                <div class="app-details">
                    <div class="detail-item">
                        ⭐ <span class="rating">{{ app.rating }}</span>
                    </div>
                    <div class="detail-item">
                        📱 <span class="category">{{ app.category }}</span>
                    </div>
                    <div class="detail-item">
                        📊 <span>{{ app.installs }}</span>
                    </div>
                    <div class="detail-item">
                        💰 <span>{% if app.price > 0 %}${{ app.price }}{% else %}Free{% endif %}</span>
                    </div>
                </div>
                <div class="app-actions">
                    <a href="{% url 'app_detail' app.id %}" class="btn btn-primary">View Details</a>
                </div>
            </div>
            {% endwith %}
        </div>

        <div class="separator">
            <div class="separator-text">Similar Apps You Might Like</div>
        </div>

        <div class="similar-apps">
            <div class="similar-apps-header">
                <div class="grid-icon">📋</div>
                <h2>Related Applications ({{ apps|length|add:"-1" }})</h2>
            </div>
            <div class="similar-apps-grid">
                {% for app in apps|slice:"1:" %}
                <div class="app-card">
                    <div class="app-header">
                        <div class="app-icon">{{ app.app_name|slice:":2"|upper }}</div>
                        <div class="app-title">{{ app.app_name }}</div>
                    </div>
                    <div class="app-details">
                        <div class="detail-item">⭐ <span class="rating">{{ app.rating }}</span></div>
                        <div class="detail-item">📱 <span class="category">{{ app.category }}</span></div>
                        <div class="detail-item">📊 <span>{{ app.installs }}</span></div>
                        <div class="detail-item">💰 <span>{% if app.price > 0 %}${{ app.price }}{% else %}Free{% endif %}</span></div>
                    </div>
                    <div class="app-actions">
                        <a href="{% url 'app_detail' app.id %}" class="btn btn-primary">View Details</a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% elif show_results %}
        <div class="no-results">No apps found matching "{{ query }}"</div>
    {% endif %}
</div>
{% endblock %}
